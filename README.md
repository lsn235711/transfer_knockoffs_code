# Transfer learning in genome-wide association studies with knockoffs
This repository contains the code to reproduce the numerical results in Ren, Li, Sesia, and Sabatti (2021).

## Folders
* numerical_experiments_synthetic_data/: contains the code to reproduce the numerical results in Section 3.1 Numerical Experiments -- Synthetic data. To replicate the experiments, one needs to run the "run-me.sh" file on a computing cluster, and then run the "plot_results.R" file to make the plots. 
* numerical_experiments_gwas/: contains the code to reproduce the numerical results in Section 3.2 Numerical Experiments -- Real genotype data and simulated phenotypes. To replicate the experiments, one needs to have access to the [UK Biobank](https://www.ukbiobank.ac.uk/) genotype data as well as to the corresponding knockoffs generated by [Sesia et al. 2021](https://doi.org/10.1101/2020.08.04.236703) ("FDR control in GWAS with population structure"). The script "choose_causal.R" is used to select the subsets of variants on chromosome one that will carry the causal signals for these experiments. The script "analysis.sh" fits the lasso model and computes the test statistics for each population. The script "analysis_transfer.sh" applies the weighted lasso transfer method, while the script "analysis_others.sh" applies the other methods. 
* real_data_analysis/: contains the code to reproduce the real data analysis in Section 4. To replicate the experiments, one needs to have access to the [UK Biobank](https://www.ukbiobank.ac.uk/) genotype data as well as to the corresponding knockoffs generated by [Sesia et al. 2021](https://doi.org/10.1101/2020.08.04.236703) ("FDR control in GWAS with population structure"). The sub-folder ./single/ corresponds to the results in Section 4.1 -- Levaraging single-phenotype prior information. To replicate the results, one needs to run "submit_plain.sh" to produce the knockoff test statistics, "submit_lasso_transfer.sh" to generate prior-informed knockoff statistics and "submit_filter.sh" to obtain the final results. The sub-folder "./multiple/" corresponds to the results in Section 4.2 -- Leveraging multi-phenotype prior information. To replicate the results, one needs to run "submit_lasso_multiple.sh" to generate prior-informed knockoff test statistics (with prior information from multiple sourcese) and "submit_multiple_filter.sh" to obtain the final results. 
* The code is specifically designed for the [Stanford Sherlock](https://www.sherlock.stanford.edu/) cluster. One may need to modify the files correspondingly. 

## References
Zhimei Ren, Shuangning Li, Matteo Sesia, and Chiara Sabatti. <b>Transfer learning in genome-wide association studies with knockoffs</b>. 2021.
